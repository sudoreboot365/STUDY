## *OSI Model*
- *physical*
	- *electrical (copper twisted pair), light (fiber optic mmf or smf), or radio waves (wireless 2.4ghz or 5ghz)*
	- *hubs and repeaters*
	- *testing cables*
	- *loopback tests on NICs*
	- *PDU: bit*
- *data link*
	- *network cards, ethernet adapters, wifi adapters*
	- *PDU: frame (add source and dest mac address)*
	- *functions*
		- *flow control - simple pause*
		- *error detection - cyclic redundnacy check (crc). if fail, just discard, doesnt request retransmission*
		- *de-multiplex between ipv4 or ipv6 packet, direct to correct protocol handler*
	- *MAC addresses*
		- *48 bit*
		- *only for devices on ethernet/wifi*
		- *only affects how a device is seen by other devices on same local network*
	- *EUI-48/EUI-64*
		- *any object including bluetooth and even software*
		- *first 3 bytes / first 24 bits = manufacturer*
		- *last 3 bytes / last 24 bits = assigned by manufacturer* 
- *network*
	- *routers*
	- *PDU: packet (add ip addresses)*
	- *functions*
		- *fragmentation - if exceeds maximum transmission unit (mtu)*
	- *protocols*
		- *IP - main protocol. connectionless*
		- *ICMP - error messages, like ping*
		- *ARP - address resolution protocol. turns ip addresses on same network into mac addresses.*
- *transport*
	- *protocol: tcp or udp*
	- *PDU: segment (tcp) datagram (udp)* 
	- *functions*
		- *flow control - sliding window protocol - telling sender to adjust transmission rate accordingly*
		- *error detection - tcp. checksum and ACKs. if fail, request a retransmit*
		- *multiplexing (adding port numbers on way out to router) and demultiplexing (direct data to right application based on port)*
- *session*
	- *controls when communication starts, stops, ends*
	- *modern: most functions have been absorbed into application and transport layer*
	- *misc functions:*
		- *checkpointing in large downloads*
		- *maintains state after authentication so dont have to re-login on every page, session stays open*
- *presentation* 
	- *​puts data into format for application*
		- *character encoding*
		- *application encryption*
	- *layer where encryption and decryption occur (examples: SSL, TLS, HTTPS)*
	- *layer where compression and decompression occur*
- *application layer*
	- *many protocols: HTTP, FTP, DNS, POP3, etc*

## *OSI review*
- *layer 7,6,5 - data*
- *layer 4 - transport (PDU: segment (tcp) / datagram (udp))*
	- *source port*
	- *destination port*
	- *sequence/acknowledgment*
		- *if sender to receiver: sequence (to re-assemble data in right order)*
		- *if receiver to sender: acknowledgement (this is what i received up to so far. send the next one)*
	- *flags*
		- *SYN, ACK, FIN (finish), RST (reset), PSH (push), URG (urgent)*
	- *window size*
		- *receiver telling sender how much it can accept to prevent overflowing*
- *layer 3 - network layer (PDU - packet)* 
	- *version (4/6)*
	- *header length*
	- *total packet length*
	- *ToS/QoS*
	- *identification/flags/fragment offset (3 fields used for fragmentation)*
	- *source ip*
	- *destination IP*
	- *TTL*
	- *protocol (tcp/udp)*
	- *header checksum*
- *layer 2 - data link layer / MAC*
- *SUMMARY*
	- *PDUs: data ⊆ segment ⊆ packet ⊆ frame ⊆ n/a (frames are written as bits)*
		- *⊆ = encapsulated inside of*
	- *LAYERS: application/presentation/session, transport (port), network (IP), data link (MAC), physical*
	- *ADDRESSING: n/a (software-specific coding tells data where to go inside each application), port, IP, MAC, n/a (the bare metal physics of semiconductors and circuits tells bits where to go)*
## *Networking Devices*
- *Outoing traffic:*
	- *Client -> forward proxy -> firewall -> IDS/IPS -> router -> internet*
	- *Server -> load balancer -> IDS/IPS -> firewall -> router -> internet*
- *Incoming traffic:*
	- *Internet -> router -> firewall -> IPS/IDS -> load balancer -> server*
- *Firewall*
	- *traditional works by TCP or UDP port*
	- *NGFW (next generation firewall) - firewalls by application. 2 firewalls can create an encypted tunnel between eahc other via VPN*
		- *most firewalls can also be layer 3 devices AKA router.*
- *Load balancer*
	- *TCP offload - instead of asking servers to do administrative work of TCP syn, synack, ack, the load balancer does it iself*
	- *SSL offload - instead of asking servers to do encryption and decryption of SSL/TSL, load balancer does it itself*
	- *Caching - frequent request arent sent to servers (like static content), but cached at the load balancer itself for quick responses*
	- *QoS - prioritizing certain traffic over others (either based on source or traffic type)*
	- *Content Switching - load balancer keeps track of which content is on which server. ex all image requests go to server A, all database queries go to server B.*
- *Proxies*
	- *for outgoing requests, perform a request on behalf othe client.* 
	- *cache results from the internet*
	- *url filtering and content scanning to block some content from the user*
- *Network Attached Storage (NAS)*
	- *file-level access - if you want to edit a file, need to download whole file to client, the write whole file back*
- *Storage Area Netowkr (SAN)*
	- *block-level access - only need to edit certain blocks*
- *Access points*
	- *translates between 802.3 ethernet and 802.11 wifi*
	- *wireless LAN controller - manages all WAPs centrally, has performance and security monitoring, can deploy changes to all WAPs at once*

## *Networking Functions*
- *Content Delivery Network (CDN)*
	- *geographically distributed caches of duplicated data.*
- *VPN*
	- *encrypted communication across a insecure public network*
	- *concentrator - encryption/decryption device. sometimes separate hardware, sometimes built into firewall*
- *QoS*
	- *prioritize traffic by application (voice call over file download), or user*
	- *can be done at firewall, router, or switch*
- *TTL time to live*
	- *ipv4 TTL - prevents inadvertent router loop*
		- *macos/linux default 64 hops*
		- *windows default 128 hops*
		- *for most internet, need about 12-16 hops, so safe limit*
	- *DNS TTL - DNS tells your computer how long to keep this DNS lookup record*


![Pasted image 20250901182152](Pasted%20image%2020250901182152.png)
## *ipv4 header*
- *version - always 4*
- *header length - min 5 (i.e. 20 bytes), max 15 (i.e. 60 bytes)*
- *QoS type*
- *total packet length*
- *identification - this is a fragment from original IP packet N*
- *flags - dont fragment / more fragments indicators*
- *fragment offset - position of this fragment relative to original IP packet*
- *time to live - prevent looping*
- *protocol - 6 for tcp, 17 for udp*
- *header checksum - error detection. if this fails, discards the packet*
- *source and destination IP*

## *Cloud*
- *virtual private cloud, connected via transit gateways (like a router for cloud networks)*
- *vpc NAT gateway (to connect private cloud subnets to external intenret)*
- *vpc endpoint (connect networks on different cloud vendors)*
- *network security list (choose what ports, inbound/outbound, and from what ip addresses are allowed to talk to your cloud network)*
- *network security group (more granularity on security rules to apply to groups of subnets)*
- *models*
	- *software-as-a-service - on-demand software. no installation, just log in.* 
	- *HaaS/IaaS - example: web server providers. customers rent servers, but have to do OS themselves, netwroking themselves*
	- *PaaS - middle ground (ex. salesforce)*

## *Internet Protocol*
- *in TCP, SYN-SYNACK-ACK is performed once per connection*
- *TCP connection ends with 4-way handshake*
	- *closes with:*
		- *client sends FIN and enters FIN_WAIT_1*
		- *server receives FIN, then sends ACK and enters CLOSE_WAIT (i won't receive anymore from you, but I still have stuff to send to you)*
		- *server finishes sending data, then sends FIN and enters LAST_ACK*
		- *client sends ACK and enters TIME_WAIT (2 minute wait, then close connection. this 2 minute wait is to make sure server received this final ACK, because if it didnt, it would resend the previous FIN)*
		- *server receives final ACK and closes connection*
	- *if any any point the process is interrupted, will retry sending a few times, then forcibly terminate with RST (reset). This is a backup mechanism.*
- *in UDP, no flow control. cant say "slow down"*
- *on server side, usually used non-epehemeral ports (i.e. HTTP is awlays 80). on client side, use temporary/ephemeral ports.*
- *max port number: 65,535*
- *FTP control - tcp/21*
- *FTP data - tcp/20*
- *SSH - tcp/22  (also SFTP)*
- *Telnet - tcp/23 (unencrypted)*
- *SMTP - tcp/25, or tcp/587 (TLS encrypt)*
- *POP3 -* 
- *DNS - udp/53*
- *DHCP - udp/67, 68*
- *TFTP - udp/69 (PXE - boot OS from network)*
- *HTTP - tcp/80*
- *HTTPS - tcp/443 (uses TLS or SSL)*
- *NTP - udp/123* 
	- *makes sure switch, router, firewall, servers, workstations all have same time*
- *SNMP* 
	- *udp/161*
	- *gather status, statistics, errors from network devices*
	- *v1 -* 
	- *v2 - added bulk transfers*
	- *v3 - added integrity, authentication, and ecryption*
	- *polling - proactive request from manager*
	- *traps - unprompted alerts sent to manager by devices (agents)* 
	- *MIB is database on agent of monitored data*
	- *OID - codes for each type of data on device (temperature of sensor, cpu utilization of router 3)*
- *LDAP*
	- *tcp/389, or tcp/636 (secure)*
	- *CN (common name AKA users) ⊆ OU (org units AKA Groups) ⊆ DC (domain component AKA organization)*
	- *attributes: name, user ID, email, telephone number*
- *SMB (server message block)*
	- *windows protocol*
		- *windows authentication (active directory)*
		- *access shared folders via `\\server-name\share-name` right in explorer*
	- *for file sharing and printer sharing over local network only, not internet*
	- *AKA CIFS (common internet file system)*
	- *old: over NetBIOS*
	- *modern: tcp/445*
- *Syslog - udp/514*
	- *used with SIEM*
- *MS-SQL - tcp/1433*
- *RDP (remote desktop)*
	- *tcp/3389*
- *VoIP SIP (session initiation protocol)*
	- *tcp/5060*
	- *tcp/5061*

## *Other Protocols*
- *ICMP (internet control message protocol)*
	- *check if a device is online `ping`*
	- *device reporting that network unreachable, or that time-to-live has expired*
- *GRE (generic routing encapsulation)*
	- *creating tunnel between 2 endpoints. mask the source and destination address with an intermediate point on both ends. the payload is not encrypted in any way, just the source and destination headers have been changed.*
-  *VPN* 
	- *will usually combine GRE tunneling/encapsulation with IPsec encrpytion*
	- *VPNs goal is to send private data over public networks*
	- *concentrator: standalone hadware, or software, or integrated into firewall device*
- *IPSec*
	- *encryption + digital signatures*
	- *IPSec is at network layer - encrypts all communication between 2 IPs, encrypts IP packets*
	- *TLS is transport layer - between 2 applications, encrypts data*
	- *2 alternative protocols:*
		- *AH (authentication header) - auth and integ only*
		- *ESP (encapsulation security payload) - encryption + auth + integ*
	- *IKE (internet key exchange)*
		- *setting up the tunnel*
		- *agree on the keys (SA = security association)*
		- *ISAKMP: diffie-hellman to create a shared secret key*
			- *udp/500*
		- *coordinate ciphers, coordinate key sizes, negotiate inbound SA, negotiate outbound SA*
		- *2 modes:*
		  ![540x144](Pasted%20image%2020250901200247.png)

## *Digital Signatures*
- *Sender sends 3 things*
	- *original data*
	- *digital signature of data = `RSAencrypt(sendersPrivateKey, SHA256(data))`*
	- *digital certificate containing sender's public key*
- *Receiver does 2 things:*
	- *extract sender's public key from the digital certificate*
	- *check if `RSAdecrypt(sendersPublicKey, digitalSignature) = SHA256(data))`*

## *Cryptography*
- *Hashing Algorithms*
	- *for integrity only*
	- *MD-5. obsolete*
	- *SHA-1, SHA-256, SHA-512. Latter 2 are preferred today*
- *Symmetric Encryption*
	- *3DES. outdated*
	- *AES. current*
	- *require less computational power, perferred for large file transfers*
- *Assymmetric Encrpytion*
	- *for digital signatures*
	- *RSA* 
	- *Diffie-Hellman (think IKE key exchange / VPNs / tunnels)*
	- *ECC (newest, better for mobile)*
- *TLS*
	- *1. authenticate each other using digital signatures (RSA)*
	- *2. securely exchange a symmetric key (diffie-hellman)*
	- *3. transfer data using aforementioned key and AES*
	- *4. check integrity of each message (SHA-256)*

## *Communication*
- *Unicast: 1-to-1*
	- *examples: checking email, visiting website*
- *Multicast: 1-to-many*
	- *Real-time streaming, stock exchange info*
- *Anycast: 1-to-one-of-many*
	- *instead of destination ip address, use a anycast ip address and router sends it to next closest hop*
	- *example: closest DNS responds, toll-free numbers*
- *Broadcast: 1-to-all*
	- *scope limited to broadcast domain*
	- *not used ipv6*
	- *destination ip address in header*
		- *Limited: `255.255.255.255` means send to everyone on this LAN*
		- *Directed: everyone on a remote network. use remote network's network ID (first half of ip), replace all host bits with `1`*
			- *usually blocked bc DDOS attacks*

## *Wireless*
- *802.11 = wifi*
- *4G/LTE*
	- *GSM and CDMA convered into 4G/LTE*
	- *based on GSM and EDGE*
	- *LTE up to 150 Mbps*
	- *LTE-A up to 300 Mbps*
		- *Mbps divided by 8 = MBps, because 8bits =1 byte*
- *5G*
	- *max 10 GBps*
	- *with new speeds, many computations better to do in the cloud*
- *Satellite*
	- *used in remote locations*
	- *typically 100 Mbps down, 5Mbps up*
	- *typical latency 250 ms up, 250 ms down*
	- *starlink: 40ms roundtrip latency*
	- *CONS: requires direct line of sight to satellite, thunderstorms*

## *Ethernet*
- *802.3*
- *Twisted-pair copper or Fiber Optic*
- *Fiber optic*
	- *pros*
		- *more secure than copper, because can't tap*
		- *>100m better, signal doesnt degrade*
		- *light has no RF interference*
		- *MMF - less than 2km*
		- *SMF - to up 100km*
	- *connectors*
		- *SC / square / simple push-pull / commonly in pairs, one transmit one receive*
		- *LC / smaller / clip lock / also in pairs*
		- *ST / bayonet twist /* 
		- *MPO (multifiber) 12 fibers in 1 cable*
- *Twsited pair*
	- *each pair has a different twist rate*
	- *differential signaling `("positive version of signal" + noise) - ("negative version of signal" + same noise) = "original undistorted signal"`*
	- *common mode signal: twisting is what makes sure the noise on both cables is equal, because neither is closer to the EMI*
	- *each pair twisted at different rates. why? if they were all twisted at same rate, the EM fields generated by the cables themselves would bleed into each other, with synchronized peaks and troughs on voltage.*
	- *connectors*
		- *RJ-11 - 6p2c - has space for 6 wires, but only uses 2.*
		- *RJ-45 - 8p8c* 
- *Co-axial*
	- *twinaxial cable*
		- *2 inner conductors, 1 for transmit, 1 for receive*
		- *pros*
			- *faster than coax*
			- *less latency than fiber optic (bc no conversion between light and EM)*
			- *cheaper than fiber optic*
		- *cons:*
			- *only 5m*
	- *Connector*
		- *F. (threaded)*
		- *BNC (bayonet)*
- *Plenum*
	- *shared airspace above the drop-ceiling.*
	- *2 materials: Teflon/FEP, and low-smoke PVC (less common, less effective)*
	- *usually less flexible*

| Name                      | Colloquial Name     | Speed    | Cable                          | Light Source           |
| :------------------------ | :------------------ | :------- | :----------------------------- | :--------------------- |
| **Twisted-Pair (Copper)** |                     |          |                                |                        |
| 10BASE-T                  | Ethernet            | 10 Mbps  | Cat3 or higher                 | N/A                    |
| 100BASE-TX                | Fast Ethernet       | 100 Mbps | Cat5 or higher                 | N/A                    |
| 1000BASE-T                | Gigabit Ethernet    | 1 Gbps   | Cat5e or higher                | N/A                    |
| 10GBASE-T                 | 10 Gigabit Ethernet | 10 Gbps  | Cat6 (55m), Cat6A (100m)       | N/A                    |
| **Fiber Optic**           |                     |          |                                |                        |
| 100BASE-FX                | Fast Ethernet       | 100 Mbps | Multimode Fiber (MMF)          | LED                    |
| 1000BASE-SX               | Gigabit Ethernet    | 1 Gbps   | Multimode Fiber (MMF)          | Short-wavelength laser |
| 1000BASE-LX               | Gigabit Ethernet    | 1 Gbps   | MMF or Single-mode Fiber (SMF) | Long-wavelength laser  |
| 10GBASE-SR                | 10 Gigabit Ethernet | 10 Gbps  | MMF                            | Short-range laser      |
| 10GBASE-LR                | 10 Gigabit Ethernet | 10 Gbps  | SMF                            | Long-range laser       |

## *Transceivers*
- *sits between the cable and the transceiver port on the switch.*
- *job is to convert signals (usually light from fiber optic, and EM fro mcopper)*
- *types*
	- *SFP - 1 gigabits*
	- *SFP+ - 16 gigabits*
	- *QSFP and QSFP+ - 4 separate signals*
		- *the transceiver has 4 separate lasers, and a multiplexer to combine the 4 wavelegnths into a single beam*

## *Topologies*
- *Star / Hub and Spoke*
	- *example. switched ethernet*
- *Mesh - multiple paths to get to destination*
	- *used in WANs*
	- *more fault-tolerant bc no single center*
	- *can also do load balancing. split data over diff paths*
- *Spine and Leaf*
	- *each spine connects to every leaf*
	- *each leaf connects to every spine*
	- *every device connects to 1 leaf*
	- *top-of-rack-switching (top of each rack has a leaf switch)*
	- *this design ensures youre no more than 1 switch away from any other leaf*
	- *this design is bad data center gets very large*
- *Point to Point*
	- *older T1 and T3*
- *three-tier*
	- *core - web servers, databases*
	- *distribution - switches*
	- *access - end stations, printers*
	- *main downside is even if 2 severs are on same rack, might have to travel all the way up and all the way back down*
	- *collapsed core - no middle distribution layer*
- *traffic flows*
	- *east-west means between 2 devices in the same data center*
	- *north-south means incoming/outgoing from data center*

## *IPv4*
- *default gateway - the local IP address of your router*
- *loopback address - 127.x.x.x. usually ping yourself at 127.0.0.1*
- *reserved addresses*
	- *[240-254].x.x.x*
	- *all class E addresses*
- *virtual IP addresses- not a physical NIC, but something like a virtual machine*
- *APIPA - 129.254.x.y*
	- *x cannot be 0 or 255*
- *NAT - how your router translates between private and public IPs*
- *multicast addresses*
	- *send data to the multicast address*
	- *devices who want to receive data use IGMP protocol to tell the router "I want to subscribe to that group". even routers outside the subnet can subscribe via PIM (think of distribution tree)*
- *broadcast address*
	- *highest possible host value (i.e. x.x.255.255, or x.255.255.255)*


| **Class**     | **first 4 binary bits** | **first decimal byte** | **Subnet Mask**      | **Network/Host bits**    | **Private range** |
| ------------- | ----------------------- | ---------------------- | -------------------- | ------------------------ | ----------------- |
| A             | 0xxx                    | [0-127].x.x.x          | 255.0.0.0 or /8      | 8/24                     | 10.x.x.x          |
| B             | 10xx                    | [128-191].x.x.x        | 255.255.0.0 or /16   | 16/16                    | 172.[16-31].x.x   |
| C             | 110x                    | [192-223].x.x.x        | 255.255.255.0 or /24 | 24/8                     | 192.168.x.x       |
| D (multicast) | 1110                    | [224-239].x.x.x        |                      | all 32 bits define group |                   |
| E (reserved)  | 1111                    | [240-255].x.x.x        |                      |                          |                   |

- *CIDR*
	- *subnetting without typical class A B and C.*
	- *since subnet mask is always 1s followed by 0s, can just write how many 1s*
		- *example. These all mean the same subnet*
			- *binary subnet mask: `11111111.11110000.00000000.00000000`*
			- *CIDR subnet mask: `/12`*
			- *simple explanation: 12 network bits, 20 host bits*
			- *decimal subnet mask: `255.240.0.0`*

## *LAN, VLAN, SDWAN*
- *VLAN*
	- *Layer 2 / Data layer / MAC address layer*
	- *12bit ID, therefore max 4094 possible VLANs*
	- *subnets are at layer 3, while vlans are at layer 2 and create broadcast domains, however in practice there is usually a 1-1 relationship between vlans and subnets*
	- *When a frame needs to be sent across a Trunk Port (link between switches for VLANs), an 802.1Q tag is added before trunk port, then stripped off before frame delivered to end device*
- *VXLAN*
	- *Layer 3 / Network layer / IP address layer*
	- *encapsulates layer 2 frames inside a layer 3 UDP packet*
	  *![[image-3.png|456x103]]*
	- *24bit ID (called VNI) therefore 16 million IDs possible*
	- *Used for DCI (Data center interconnect)*
	- *mostly used to solve the scalability issues of VLANs. 2^12=4096-2 → >16million*
- *SDWAN*
	- *for geographically distributed offices and users*
	- *put into a single network in the cloud*

## Zero Trust
- every user/device/application, even inside the network must be verified
- Policy-based authentication (who are you?)
	- Adapts to situation
		- long employee / new vendor
		- inside building / IP address another country
		- unusual time of day
	- decide: grant, deny, revoke
- Authorization (what kind of access?)
	- Least privilege access
- SASE (secure access service edge)
	- cloud-based security for SDWANs software defined wans

## Infrastructuer as Code (IaC)
- a configuration file that can describe our infrastructure
- instructions to the cloud on how to build our network
- Playbook
	- series of re-usable steps to do network admin tasks (investigate a data breach, recover from randsomeware, etc)
	- third party SOAR platforms (security orchestration automation and response)
- Advantages
	- configuration drift 
	- easy testing environments
	- version control of config files
	- many people can work on their part of the code (branching)
		- ways to manage merge conflicts

## *IPv6*
- *32bit/4bytes --> 128bit/16bytes*
- *basics:*
	- *8 bits = 1 byte*
	- *4 bits = 1 hexadecimal char*
		- *therefore 2 hexadecimals = 1 byte*
		- *therefore 32 hexadecimals = 16 bytes = ipv6 address*
- *communicate w ipv4*
	- *tunnel - encapsulate one inside another*
		- *6in4 - cons: requires relay routers. no support for NAT*
		- *4in6 -* 
	- *dual stack -  device can communicate in both.*
		- *application decides which to use.* 
		- *NAT64-capable router and DNS64 server*
	- *translate - convert*
- *Routing tables*
	- *tables mapping destination IPs to next hop router ip address*
	-  *static tables* 
		- *good for smaller networks, stub networks, no CPU/memory/bandwidth overhead*
		- *bad for large networks, network changes, human error routing loops*
	- *dynamic routing*
		- *routers send routes to each other automatically. requires more router overhead (EIGRP updates)*
		- *in reality, your home router doesnt have most of hte internets IP addresses on its routing table, so it will send the packet to your default gateway, which is your ISP, which has huge routing tables*
		- *routing protocols*
			- *distance-vector: only knows total hops to destination and next-hop*
			- *link-state: every router knows full topology*
			- *RIP*
				- *simple distance-vector*
				- *limited to 15 hops*
				- *slow voncergence*
				- *obsolete*
			- *EIGRP*
				- *CISCO proprietary*
				- *advanced version of distance-vector, not a full 100% topoogy*
				- *fast convergence*
				- *no loops*
				- *easy to set up*
				- *hybrid: based on both distance and link-state*
				- *load balances even over higher cost routes*
			- *OSPF*
				- *common for interior networks*
				- *link-state*
				- *usually used when you have complete control of all systems (AS autonomous system)*
				- *available on all routers*
				- *best route determined by the "cost" which is the level of bandwidth between routers* 
				- *can load balance between equal cost routes (ECMP equal cost multiple paths)*
			- *BGP*
				- *used on exterior networks, like the www*
				- *path-vector*
				- *three-napkins protocol*
				- *path-vector protocol - routing decisions are based on policies and a long list of attributes*
	- *entry fields*
		- *![[image.png]]*
		- *administrative distance - score based on what protocol added entry to routing table*
			- *if multiple entries which match, choose the most specific (i.e. longest subnet mask bc longest matching prefix)*
			- *local (0) < static route (1)  < EIGRP (90) < OSPF (110) < RIP (120) < DHCP default route (254)*
		- *routing metrics cannot be compared across protocols, but always choose the lower of 2.* 
		- *timer is how long since this route has been added*
		- *last field is egress interface - the physical port to leave the router*
	- *first hop redudnancy protocol (FHRP)*
		- *what happens if primary router fails? set default gateway to a virtual IP which can be switched from 1 physical router to another*
	- *subinterface*
		- *an interface is just the representation of a port on the switch's software*
		- *usually exists between a router and a switch.*
		- *notation usually looks like: `interface 0/0.1`, `interface 0/0.2`, `interface0/0.3`*
		- *each vlan has a different default gateway. but in reality, they should all go to the same router. so to avoid having separate port/interfaces 1 per default gateway, just split up the port/interface on the router into subinterfaces.*
- *NAT network address translation*
	- *PAT (aka NAT overload) just add a port per device on internal network*
- *LAN* 
	- *group of devices on the same broadcast domain / connected to same switch*
	- *VLAN trunking*
		- *802.1Q*
		- *single ethernet cable to connect 2 switches. now vlans on different switches can be part of the same VLAN*
		-  *![[image-1.png|521x132]]*
		- *VLAN tag is 12 bits long*
		- *obsolete version is ISL*
	- *default VLAN*
		- *every port on the switch is on this VLAN 1 by default*
	- *native VLAN*
		- *if sent without a VLAN tag, the 802.1Q trunk* 
	- *switched virtual interfaces SVI*
		- *if switch and router are combined within the same physical device (AKA layer 3 switch), need a way to simulate the multiple interfaces/ports that would have existed between the router and switch which would have been necessary to create inter-VLAN routing*
- *Voice and Data*
	- *voice needs more consistent data stream*
	- *voice and data re usually separated into separate VLANs*
	- *usually connect computer -->VoIP phone --> switch, because phone has an internal switch that says to forward all traffic without a VLAN tag. all data generated by phone itself has VLAN for voice traffic tagged onto it. "pass-trhough" function* 

## *Interface Configurations*
- *ethernet:* 
	- *speed: 10mb/100mb/1gb/10gb*
		- *must be the same on the computer and switch side. often set automatically*
		- *wont work at all if mismatch*
	- *duplex: half/full* 
		- *also set automatically*
		- *will worth if mismatched,  but poorly*
	- *ip address management configuration*
		- *VLAN interfaces*
		- *ip address*
		- *subnet mask*
		- *default gateway*
- *link aggregation (LACP)*
	- *increases bandwidth by bundling two physical links together. sees 2 cables as a single one.*
	- *mostly used to connect 2 switches and increase bandwidth between them*
	- *if done incorrectly, network loops and broadcast storms*
- *MTUs*
	- *the largest size packet that can be sent before fragmenting*
	- *standard MTU is 1500 bytes.*
	- *ipv6 does not fragment, only drops*
- *Jumbo frames*
	- *up to 9000 bytes*
	- *every device on path must understand jumbo frames. if it doenst, will drop frame*

## *Spanning Tree*
- *if 2 cables connect to each other, no counting mechanism at the MAC level to find loops. quickly brings down networks*
- *802.1D spanning tree protocol* 
	- *prevents loops. a feature built into switches that admins can turn on or off.* 
	- *admin sets the bridge priority of each switch*
	- *every switch on the network multicasts bdpus to its neighbors declaring they are the root, but whoever has a lower bridge priority wins as the root, and this process iterates through the network until a single root is elected for the entire network.*
	- *then every switch calcualtes its best path to the root bridge based on link speeds.* 
	- *then using those calculations, some ports are set in forwarding, others are blocked.*
		- *blocking (20s) - All ports start in the blocking state when a switch is powered on or a new link is connected. In this state, a port is sending BPDUs, listening for BPDUs, and processing BPDUs from neighboring switches. It does not forward any user data.*
			- *root bridge election - all switches compare bridge IDs which allows the network to iteratively elect a root bridge*
			- *path cost calculation - switches use bdpus to calculate each switchs lowest cost to teh root*
			- *role assignment - if a switch has 2 routes to the root, then there must necessarily exist a loop, so the port leading to the higher cost route is assigned to be non-designated/blocked. all other ports are designated/open.*
		- *listening (15s) - all designated/open ports begins sending and receiving BPDUs. waiting for other swithces convergence.*
		- *learning (15) - - The port moves to this state. It continues to send and receive BPDUs, and it builds a mac address table (for each immediate neighbor, if i want to reach their MAC, go out this port).* 
		- *forwarding - The port is now fully active. It forwards user data, and it continues to send and receive BPDUs to monitor the network for any changes in the topology.*
- *802.1w rapid spanning tree*
	- *from 30 seconds to 6 seconds.* 
	- *can also assign ports as roles as (1) alternate port and (2) backup port*
	- *instead of blocking state, in 'discarding' state. listening and learning but just discards all frames to prevent loops.*

## *Wireless*
- *![[image-2.png|781x211]]*
- *choosing bandwith determines how many channels will be overlapping*
- *band steering*
	- *if off, just chooses between 2.4 or 5 by whichever has stronger signal*
	- *if on, can force it to use the faster 5*
- *regulatory impact per country*
- *802.11h - prevents wifi from itnerfering with radar (weather, miliary, air control) requires 2 things:*
	- *DFS - switch to diff non interfering channel*
	- *TPC - reduce power*
- *ITU guidelines - worldwide stnadards*
- *ad-hoc connection / IBSS / IoT - no router / central acces point. every device is both netwokr nad host*
- *security modes - WEP, WPA 1/2/3...*
	- *personal/PSK - everyone uses same password*
	- *Enterprise / 802.1x - each person has own username and password*
- *Omnidirectional antenna - not good if in corner.*
- *Directional antenna - power measured in db.*
	- *yagi antenna (Christmas tree)*
	- *parabolic antenna (concave)*
- *autonomous access points - has its own software in the hardware*
- *lightweight acess points in corporte buildings. all intelligence is handled by the switch, all controled from a single "pane of glass" / wireless LAN controller.* 
	- *easily deploy new accessp oints,* 
	- *performance and security monitoring*
	- *configure and deploy all changes at once*
- *Network types*
	- *wireless mesh. multiple access points all communicate to each other. ![[image-4.png|116x91]]*
	- *ad-hoc. no access point. direct bteween 2 devices. used often with IoT.*
	- *point-to-point. like connecting a company in 2 separate buildings. ![[image-5.png|259x95]]*
		- *maye need power adjustments and frequency adjsutments*
	- *infrastructure mode. 1 central access point ![[image-6.png|142x110]]*
- *Wireless encryption*
	- *WEP - vulnerable*
	- *WPA - temporary, works on same hardware as WEP*
	- *WPA2 - since 2004.* 
		- *CCMP block cipher mode*
		- *encryption : AES*
		- *integrity check : CBC-MAC*
	- *WPA3*
		- *GCMP block cipher mode*
		- *encryption: AES*
		- *integrity check : GMAC*

## *Installing Network*
- *Distribution frame*
	- *passive cable termination (punch down blocks, patch panels) to prevent signal reflection*
	- *MDF - main. room called MDF. often in center in data center.*
	- *IDF - intermediate* 
- *Racks*
	- *19 inches wide*
	- *height is measured in 1U=1.75 inches*
		- *most racks are 42U tall*
	- *some racks are locked for extra security*
- *Heat*
	- *desining HAV need to consider power requirements and fire system*
	- *all hot air from back of equipment points in same aisles*
- *Cables*
	- *general principle is never touch a cable once its installed once. cables from desk to patch panel are installed once and never touched again. only need to change connections from RJ45 to switch*
	- *![[image-7.png|232x202]]*
	- *for fiber optic distribution panels, msut consider bend radius*

## *Power*
- *always disconnect a device's power before working on it*
- *some devices can store charge (CRT monitors, laser printers)*
- *amp - diameter of the hose - how many electrons passing through a point in 1 second*
- *voltage - pressure of the hose -* 
- *watts - how much power being used*
	- *watts = volts x amps*
- *alternating current*
	- *good over long distances, so brings power into your home*
	- *USA/canada = 110-120v*
	- *europe = 220-240v*
- *direct current*
	- *our appliances usually use this*
	- *power supply on device converts AC from wall into DC*
- *UPS uninterruptible power supply*
	- *contains batteries.*
	- *voltage drops - brownout*
	- *voltage spike - surge*
	- *offline/standby - but small switching time which would cause routers and switch to reset*
	- *line-interactive - comes online if brownout*
	- *online / double conversion - always running from battery, and constantly charging batteries*
- *PDU power distribution unit*
	- *can remotely power on/off each interface.* 
	- *has ethernet port to manage the device*

## *Environmental Factors*
- *humidity*
	- *too high humidity bad for electronics*
	- *too low humidity promotes static discharge*
	- *40-60% is ideal*
- *temperature*
	- *64-81 fahrenheit is optimal*
- *fires*
	- *inert gas / chemical suppressant*

## *Network Documentation*
- *physical network map*
- *logical network map*
- *rack diagrams (location = row #, rack #, rack unit #)*
- *cable map*
- *network diagrams - switches and routers, with each interface labeled w (1) physical interfaces (2) mac adresses (3) ip addresses*
  *![[image-8.png|492x176]]*
- *asset management*
	- *to refer to in trouble tickets*
	- *to refer to in financial records. under warranty? how depreciated?*
	- *what software versio nis running on device?*
	- *use barcode or RFID*
- *IPAM ip address management*
	- *track what users are using what IPs*
	- *manage DHCP reservations*
- *SLA service level agreement*
	- *ex with ISP, up 99.99% of time, no more than 4 hours of downtime*
- *Site surveys*
	- *see wireless landscape so we can have minimum interference w other organizations*

## *Life Cycle Management*
- *EOL - end of life*
	- *manufactor stops new software and updates of new features*
	- *may continue with security and updates.*
- *EOS - end of support*
	- *no more security update*
- *Firmware*
	- *hardware specific sofware and OS*
	- *should have rollback plan to older versions*
- *Decomissioning*
	- *sanitize the data / destroy the device*
	- *legal issues: not allowed to destroy some data, so store offsite*
- *Change management*
	- *when upgrading software or changing configurations, we need to have clear policies*
- *Service Request Tracking*

## *Config Management*
- *Document changes* 
- *Production config - currently in use now*
- *Backup config* 
	- *-snapshot of past prod*
	- *how? copying files, snapshot of VM*
- *Baseline/Golden config*
	- *standardized ideal config for a device/system.*
	- *software, security settings, general settings*

## *SNMP*
- *manage devices from central station*
- *MIB*
	- *management information base. database*
	- *mib walker / mib browser - program to see all of mib*
	- *mostly queries on a scheduled regular basis*
	- *trap*
		- *instead of regular intervals, proactive triggers to issues*
		- *udp/162*
	- *community string*
		- *aka password for the mib. separate ones for read, read-write, traps*
- *OID*
	- *1 per of reporting variable*
	- *definitions are mostly standardized across manufacturers and devices, but may be some device and manufacturer specific ones*
- *versions*
	- *v1 - structured tables, but sent data without encryption*
	- *v2c - query chunks of data, still not encrypted*
	- *v3 - message integrity, authentication, encryption*

## *Logs & Monitoring*
- *NetFlow*
	- *made by CISCO but widely adopted*
	- *summary of traffic from probes/taps/exporter and sent to a single collector*
	- *netflow aggregates data from the metadata in packets*
- *Top Conversations*
	- *any exhcnage of data between 2 IP endpoints. can both be inside or outside your network. usually if 15 seconds of inactivity, consider new conversation.*
- *Top endpoints*
	- *Endpoint is a single ip address. can be both sender or receiver.*
- *Top Applications*
	- *aggregate by port number*
- *Protocol Analyzer*
	- *analyze each actual packet*
- *Network Performance Baseline*
	- *picture of what a "normal" day looks like. so we can know when things are abnormal.*
	- *look for patterns for anomolies*
- *Syslog*
	- *the standard for transferring log files, even though different devices and manufacturers*
	- *data usually sent to a SIEM*
- *SIEM*
	- *rolls up data into aggregated reports/ real-time dashboards*
	- *often a newly reporting device (netflow device, syslog enabled server, routers, switches, firewalls) overrports data nad the SIEM is overwhelmed with irrelevant data*
		- *only store 'warning' and 'urgent' and discard 'informational'*
- *Managing routers/switches*
	- *method 1: ssh into each device*
	- *method 2: APIs*
		- *batch processes to do many different things, to many devices*
		- *interact with cloud services, firewalls, OSes*
- *Port Mirroring*
	- *how we gather packets from a port*
	- *also for security: IDS / IPS*
	- *also for performance monitoring*

## *Network Solutions*
- *network scans - how to gather information from our network (LLDP discovery protocol, CDP cisco data protocol, IP scanners aka nmap, commercial network scanners)*
- *looking for things liek*
	- *high bandwidth usage*
	- *availability - is a device up or down?*
	- *all statistics both real-time or collected over time*
- *a device's configuration files can usually also be downloaded or uploaded, so they are usually stored. purposes:*
	- *to revert to previous state*
	- *to compare same devices with diff configs*
	- *monitor and alert on change*

## *Disaster Recovery*
- *backups, off-site data replication, cloud based servers, remote sites, third party recovery services, third party remote locations*
- *RTO (recovery time objective) - time o resume operations back to normal service level. you must define normal.*
- *RPO (recovery point objective) - how much data went through our system right before the outage, and was lost forever because itw as not stored.*
	- *banks/medical - shoudl be short. websites can be an hour.*
- *MTTR (mean time to repair) - how long to repair ___ (like a router)*
- *MTBF (mean time between failures) - how long a ___ lasts, like a firewall lasts 20 years, so only need 1 backup*
- *Site resiliency - recovery site if disaster happens. transfering hardware, power, data. Work at backup facility for hours, days, weeks, months. Ways*
	- *cold site - empty building*
	- *hot site - exact replica. hardware, and data and applications all running there.* 
	- *warm site - hardware, racks.* 
- *Tabletop - disaster drill on a table*
- *Validation tests - full physical simulation*

## *Network Redundancy*
- *Active-Passive*
	- *only 1 device active, and if it fails, other takes over*
	- *configuration and data are constantly synced*
- *Active-active*
	- *both devices running simultaneously.*
	- *if one fails, traffic which was originally split over 2 devices just automatically flows through 1*
	- *more complex to design traffic flows*

## *DHCP*
- *bootstrap protocol / BOOTP*
	- *con: if someone left network, didnt know when IP was available again*
- *DHCP*
	- *discover - are there any DHCP servers out there?*
		- *0.0.0.0:udp/68 →  255.255.255.255:udp/67*
	- *offer - all DHCP servers reply "i have this one available"*
		- *DHCP's ip :udp/67 → 255.255.255.255:udp/68* 
	- *request - tells all DHCP servers which one it has chosen*
		- *0.0.0.0:udp/68 → 255.255.255.255:udp/67*
	- *acknowledge - gives a lease for that address*
		- *DHCP's ip :udp/67 → 255.255.255.255:udp/68*
- *Keeps track of past mac:IP mappings, so if you reconnect in the future nad your ip is available, you'll get the same one*
- *Difficult for larger enterprises, because broadcasts only go up to switch.*
	- *many routers enable DHCP-helper/relay*
	- *converts destination from broadcast to DHCP server (knows where it is)*
	- *converts source from 0.0.0.0 to itself, the router.* 
- *Configurations*
	- *scope*
		- *the range from where to give out, and what to exclude*
		- *reservations (devices that always get same ip)*
		- *subnet mask*
		- *lease durations*
		- *DNS server, default gateway*
- *DHCP renewal*
	- *T1 timer*
		- *by default, 50% of lease time.* 
		- *check in with DHCP*
	- *T2 timer*
		- *if no DHCP responded in first, checks with ANY DHCPs to try to renew*
- *Options (sent along with ip address assignment)*
	- *here's the ip address of the call server*
	- *here's the ip address of the HTTP proxy*
	- *the reason why this is done with the DHCP server is because DHCP performs all "client-pull" functions. i.e. when a new device ocnnects, its broadcasting "hey i need network settings!"*
	- *when "manager-pull" functions are needed, SNMP is a better central manager (management, monitoring)*
	- *DHCP configures devices with all initial configs*
	- *SNMP monitors devices*

## *IPv6*
- *stateless address (SLAAC)*
	- *no DHCP, devices assign to themself.*
	- *avoids conflicts via DAD (dupicate address detection), most important step of SLAAC.*
		- *sends NS (neighbor solicitation) message (is anyone using this ip?)*
			- *send to the desired IP's "solicited node multicast address", so that this NS is only sent to other IPs which would also be subscribed to the same multicast. sending the NS to a smaller group than a broadcast.*
		- *if nobody responds with NA (neighbor advetisement), then it uses IP*
- *Neighbor MAC discovery*
	- *ipv6 version of ARP*
- *Router solicitation (RS) and Router Advertisement (RA)*
	- *because all routers and nodes are by defualt are subscribed to a router-only and node-only multicast group*

## *DNS*
- *translate human domain names into ip addresses*
- *there are 13 DNS clusters, with >1000 total servers*
- *FQDN fully qualified domain name* 
- *often our computer has a primary and secondary DNS specified*
- *can manually resolve names / locally resolve name*
	- *hosts.ini file*
	- *some apps circumvent hosts file*
- *forward lookup - send name, receive IP `dig name`*
- *reverse DNS - send IP, receive name `dig -x ip`*
- *usually getting info from non-authoritative server, which just caches information*
	- *but cached information may be outdated.  so each entry has TTL, so further requests beyond TTL wil lgo to authoritative.*
- *security*
	- *DNSSEC - responses are digitally signed, so we know integrity/not changed*
	- *DNS over TLC (DoT)*
		- *tcp/853*
		- *encrypted with TLS/SSL*
	- *DNS over HTTPS (DoH)*
		- *tcp/443*
- *DNS records. input: domain name. output:* 
	- *A - maps name to ipv4*
	- *AAAA - maps name to ipv6*
		- *new devices cant connect, but old can--> your AAAA record is wrong.*
	- *CNAME - alias*
		- *when a single server has multiple functions like mail, www, ftp*
	- *MX - ip address of mail server which handles email for a domain*
	- *NS - points your local NS to the master NS for each particular domain*
	- *SOA (Start of authority) - metadate about DNS, admins email, serial number, etc*
		- *retries, expirations, TTL, cache duration*
	- *TXT (text)*
		- *SPF (sender policy framework) - list of allowed ip addresses allowed to send email with this domain name*
		- *DKIM (domainkeys identified mail) - public keys for digital signature on email*
		- *DMARC (domain-based message auth) - if fail SPF or DKIM, do nothing, quarantine, or reject?*
	- *SRV (service)*
		- *hostname + port, instead of just hostname/ip address.*
	- *PTR (pointer)*
		- *reverse lookup, ipadress -> domain name*
		- *example: check if email really came from domain it claims*
		- *lives in a compeltely different zone from other records, the `in-addr.arpa` or `ip6.arpa`*

## *Time Protocols*
- *NTP (network time protocol)*
	- *synchronize clocks on all devices*
	- *NTP server udp/123, responds to time requests*
	- *NTS security, requires a NTS-KE server. makes sure clients all have a cookie.*
		- *why separate device for authentication? authentication is computationally heavy, and NTP server handles millions of requests per second.*
		- *symmetric key* 
	- *![[image-9.png|299x165]]*
	- *PTP (precision time protocol)*
		- *hardware based*
		- *nanoseconds*

## *VPNs*
- *encrypt data so that private data can traverse public network*
- *concentrator*
	- *often built into firewall / separate hardware / sometimes software*
	- *encrpytion/decryption device*
- *client-to-site, site-to-site*
- *clientless VPN*
	- *runs inside browser with HTML5, no software needed*
	- *traffic in this single web based session to this particular website will be VPNed*
- *split vs full traffic*

## *Remote Access*
- *SSH (tcp/22) - terminal*
- *RDP - microsoft remote desktop GUI*
	- *clients do not need to be windows*
- *VNC (virtual network computing)*
	- *open source*
	- *can be used on any OS*
- *APIs*
	- *instead of SSHing into each device, for each operation, interact with devices programatically*
- *Console port*
	- *if you connect to this port with a serial connection (DB-9, RJ-45, or USB) you have terminal access to that device*
	- *works even if ip address wrong, network down, network card malfunctioning*
	- *gives you a CLI specific for that device*
- *Jump server*
	- *SSH/Tunnel/VPN into the jump server first, then RDP/SSH into a device from there*
	- *![[image-10.png|334x182]]*
- *In-band management*
	- *the same IP address and same interface as device's regular traffic is used for its management*
	- *con: if network fails, you lose both functionaity and management access to this device*
- *Out-of-band*
	- *works when network is down*
	- *comm server is a single server that connects to many devices through their console*

## *Security*
- *data in transit / data in* 
	- *AES - encryption only, used by both TLS and IPSec*
	- *TLS/SSL - encrypt + auth + integrity, all at application layer (6+7)*
	- *IPsec - encrypt + auth + integrity, at Internet layer (3)* 
- *data at rest*
	- *whole disk encryption*
	- *database/file/folder level encryption*
	- *permissions with ACLs*
- *PKI (public key infrastructure)*
	- *lots of digital keys, certificates*
- *CA certificate authority*
	- *says "you can trust this website"*
- *Self-signing Certificates*
	- *build your own CA*
- *Recall that the receiver of data must check if `decryptAlgo(sendersPublicKey, digitalSignature(sender,data))` = `hashingAlgo(data)`*
	- *but what if both the digital signature AND hte public key have been intercepted and repalced?*
	- *solution: add a digital signature to the key also*
	- *adds another layer, the chain trust ultimately terminates at a root CA (certificate authority)*
		- *ex. digicert, sectigo, globalsign. These public keys are pre-installed in browsers, OSes, and devices, so they cannot be intercepted and replaced.* 
- *IAM (identity and access management)*
	- *Problem*
		- *Applications are spread (desktop, mobile, browser)*
		- *Data is spread (cloud, data centers)*
		- *Users are spread (employees, vendors, contractors, customers)*
	- *Solution is IAM*
		- *entities for human and nonhuman identities*
		- *access control*
		- *authentication and authorization*
		- *governance (track who did what, for audits and regulations)*
	- *Least privilege*
		- *give people the minimum access necessary*
	- *RBAC role based access control*
		- *user-to-role mapping + role-to-permission mapping*
		- *why? easier to assign a user to 'accountant'*
		- *in windows, called 'groups'*
	- *Geographic based restrictions*
		- *ip addresses used, but not most accurate. wireless access point slightly better. GPS best.*
		- *geofencing - access based on location*
- *Physical Security*
	- *cameras/CCTV. motion detection, read license plates, facial recognition.*
	- *door locks. pins, RFID badges, biometrics (finger, retina),* 

## *Identity Management*
- *authentication - who are you*
- *authorization - what are you allowed to do*
- *accounting - what did you do*
- *SSO (single sign on) - once per session*
- *RADIUS*
	- *way to authenticate*
	- *how the firewall/vpn concentrator talks to the AAA server.* 
	- *also used for wifi login*
- *LDAP*
	- *give more details about a user besides username and password.*
	- *x.500 is an established set of attribute-value pairs*
		- *CN - common name, ex. widgetweb*
		- *OU - organizational unit, ex. marketing*
		- *O - organization, ex. widget*
		- *L locality, ST state, C country*
		- *DC - domain component, ex. .com*
- *SAML (security asserition markup language)*
	- *An open standard for exchanging authentication and authorization data between an Identity Provider (IdP) and a Service Provider (SP).*
	- *not good with mobile*
	- *server w the resource we want redirects us to an authorization server, where we can log in, then receive a SAML token, then we provide that token to the resource server.*
- *TACACS*
	- *CISCO centric, but now an open standard*
- *Multifactor*
	- *something you know - password* 
	- *something you have - mobile app / time-based, one-time password (TOTP)*
	- *something you are - biometric*
	- *somewhere you are - GPS location*

- *Honeypots*
	- *attract the bad guys*
	- *need servers, workstations, routers, switches, firewalls, proxy servers, authentication server*
- *CIA Triad*
	- *Confidentiality - restrict access to data / encrypt data*
	- *Integrity - data has not been modified, i.e. digital signatures*
	- *Availability - systems and networks are up*

## *Regulatory Compliance*
- *data localization - data must stay inside country*
	- *GDPR*
		- *in EU, protection and privacy of individuals*
		- *data on EU citizens must stay in EU*
		- *users can remove data*
- *PCI DSS - protects credit card information*
	- *has some mandated segmentation rules*

## *Segmentation*
- *physical, logical, or virtual segmentation of network*
- *key principle: devices which are 1️⃣ easier to hack and/or 2️⃣ more damaging to be down, the miore important it is to segment them*
- *IoT devices (Often segmented for bad security)*
	- *sensors for heat, light*
	- *smart devices for hoem automation, video doorbells*
	- *wearables - watches, health monitors*
- *IIoT (industrial IoT)*
	- *more data is at stake, so also segmented for security*
- *SCADA/ICS*
	- *think: factories, manufacturing, power generation*
	- *multi-site industrial control systems*
	- *because lots of equipment are old and not built with modern security in mind*
	- *controls power, equipment, facilities, logistics*
- *Operational Technology*
	- *think: electric grids, traffic lights, manufacturing plants*
- *Guest network - separate network for guests*
- *BYOD - your private information remains private on your device, but companys data is segmented.*

## Denial of Service
- overload system
- can be by competitor, or a distraction, or unintentional (like a loop)
- distributed DDOS - many devices coordinated
	- assymetric threat - attacker has few resources but can take down larger 
- DDOS reflection an amplification
	- NTP, DNS, ICMP can all amplify a small message
	- because DNS only takes a small input, but returns a large output (the public key), if the attacks spoof their source IP as the targeted webserver, we can send a ton of information to the websetver
		- other reasons why DNS: because DNS uses UDP, connectionless, no handshake back and forth to add bandwidth cost to the transaction

## VLAN Hopping
- at work, VLANs for accounting, marketing, shipping
- at home, VLANs for normal, IoT, cameras
- Hopping
	- switch spoofing
		- some switches can change between 1️⃣ an interface for a device and 2️⃣ an interface for a switch AKA trunk. if you switch to a trunk, it could create a trunked connection. basically pretend you are a switch.
		- administrators should disable trunk auto-negotiation
	- double tagging
		- attacker is connected to switch 1. switch 1 is connected to switch 2 via trunk. the attacker cannot access switch 2 which is on desired VLAN of attack, but he can access switch 1 which is more accessible, and also has as trunk to switch 2.
		- attack sends a frame with inner tag of the targeted VLAN, and an outer tag of the default VLAN. this frame is sent to switch 1 
		- switch 1 is normally supposed to drop ALL tagged frames, but because of a legacy functionality to make switches backwards compatible pre-VLAN devices, it will not drop the malicious frame with an outer tag for the default VLAN.
		- switch 1 accepts this frame, strips off the outer tag, and sends it down the trunk to switch 2.
		- switch 2 now only sees the remaining tag for the targeted VLAN, does not know it was stripped of anything beforehand, and sends the frame to VLAN B.
	- doubel tagging is a 1 way trip, cannot have any response back, so good for DDOS
	- double tagging exists as a function because standard VLAN only supports up to 4096 VLANs, so need a larger namespace.
	- solution: change the native VLAN ID
	- solution: disable native VLAN entirely on trunks

why is the behavior of a switch to accept all frames with the default vlan?
why does the feature of double VLAN tagging a frame exist?
why does the attacker just send the malicious frame straight to the 2nd switch?
## MAC Flooding
- 48 bits / 6 bytes. first 3 bytes are OUI aka manufacturer. last 3 bytes are NICU serial number.
- stored in ROM, is burned in
- switch always building table of mac addresses on entwork, and at which interface its connected
- switches cache that information about every 5 minutes
- spanning tree protocol also uses these mac address tables 
- attacker sends traffic with many different source MACs to fill up the table
- default behavior when switch doesnt know destination is to send it to everyone, so one will reply.
- we've essentially turned a switch into a hub
- mac flooding mostly prevented now by built-in features into switches. limiting how much it can learn from 1 port

## ARP and DNS poisoning
- spoofing emails and phone numbers
- how to sit in the middle of a conversation
	- ARP poisoning / IP spoofing
		- attack sends an ARP reply to a computer saying "I am [ip address of the router]. my mac address is [attackers mac address]",
		- attacker sends an ARP reply to the router saying "I am [ip address of the targeted computer]. my mac address is "attackers mac address]"
		- why ARP?
			- ARP is stateless - doesnt remember any previous convos. just updates with most recent
			- ARP trusts all replies
		- how to defend against it?
			- stop auto updating ARP. on important devices, ARP tables on key routers and servers arestatic and manually defined.
			- DHCP snooping. the DHCP (which is at a higher level of OSI model at application layer 7) does know the correct IP to mac table. the switch (at layer 2) passively listens to all DHCP conversations on the network to build its trusted database of IP-to-MAC mappings then uses DAI (dynamic ARP inspection) to vlaidate all incoing ARPs and drop forged ones 
	- DNS poisoning
		- send fake replies to valid DNS requests
			- modify the DNS servers database itself
			- modify the hosts file on the client
			- must be done in real-time / on-path attack / man-in-the-middle
		- how to defend?
			- add digital signatures to DNS conversations

## Rogue
- rogue DHCP
	- just add a malicious DHCP server to the network.
	- solution? 
		- each time an network admin sets up a new DHCP server, the network admin registers it as legitimate within microsoft active directory
		- DHCP Snooping - sets which ports are trusted DHCP ports
- rogue access point
	- can plus a cheap WAP into any ethernet connection.
	- solution: periodic survey of building
- wireless evil twin
	- same network name SSID, or same captive portal
	- usually boost power over legit network
	- solution? use HTTPS or VPN, so even if you are on a evil twin, its encrypted. this is a solution for all on-path attacks

## Social Engineering
- phishing
	- solution: check the URL. for emails, check the "@xxx.com"
- shoulder surfing
	- solution: understand surroundings, screen privacy filters
- tailgating / piggybacking
	- tailgating - legit person doesnt know
	- piggybacking - legit person gives consent and knows
	- solution: 1 scan, 1 person. 
- dumpster diving
	- as long as no local laws and not private property, dumpster diving is legal in the US
	- solution? lock garbage. shred garbage. burn garbage.

## Malware
- viruses replicate and spread with human interation
- worms replicate and spread with no interaction
- ransomware encrypts your data, and demand money
- trojan horse pretends its  something else, liek a game
- rootkit hides within the OS
- keylogger captures all keys
- adware/spyware shows you ads
- bloatware is preloaded, often has active running processes using resources
- logic bombs, waiting for a time or date
- solution?
	- dont click email links. 
	- dont click pop ups
	- keep OS updated

## *Device Security*
- *ports*
	- *close all ports except those required*
	- *use firewalls*
	- *many services we dont know about are using ports we dont know about*
	- *nmap can scan what ports are open*
- *changing default credentials on router set by manufacturer*
	- *routerpasswords.com*
- *switch ports*
	- *alerts when a new MAC plugged in* 
	- *can specify which macs allowed on hwich interfaces*
	- *disable any unused interfaces*
	- *NAC / 802.1X - RADIUS/TACACS+*
		- *NAC = network access control, the whole security strategy*
		- *802.1X is a standard for port security*
		- *RADIUS = backend server dealing with authentication*
- *MAC address filtering*
	- *weak bc macs can be spoofed*
	- *only works bc security by obscurity. depends on attacker not knowing that youre using it.*
- *Key management system*
	- *renew keys, revoke keys, see when people using keys, see when they will expire*

## *Security Rules*
- *Access control lists*
	- *rules on what is allowed, combinations of source ip, destination ip, time of day, application*
- *Firewalls*
	- *implicit deny. go down a list of rules until it matches criteria. if none, deny.*
	- *rules usually listed specific to general*
- *URL filtering*
	- *block certain URLs, or a category of URLs called URI*
	- *users can get around these*
	- *many firewalls have categories of URLs built in*
- *Content filtering*
	- *NSFW content*
	- *sensitive corporate data*
	- *anti-virus, anti-malware*
- *Screened subnet*
	- *visitors to our network have access to certain resources on our network, but not the whole network (i.e. public webservers)*
- *Security Zones*
	- *alternative to IP address ranges in firewall rules*
	- *examples: internal, external, servers/DMZ/publically accessible, databases*

## Cable Issues
- fiber optic
	- MMF core is 50/62.5 microns
	- SMF core is 9 microns
- copper cables

| **CAT** | **max rated speed** | **max rated distance** | **shielding** | **addt'l capable**            |
| ------- | ------------------- | ---------------------- | ------------- | ----------------------------- |
| 5       | 100mb               | 100m                   | UTP/STP       | but also 1g capable over 100m |
| 5e      | 1g                  | 100m                   | UTP/STP       |                               |
| 6       | 1g                  | 100m                   | UTP/STP       | but also 10g capable over 55m |
| 6a      | 10g                 | 100m                   | UTP/STP       |                               |
| 7       | 10g                 | 100m                   | S/FTP only    |                               |
| 8       | 40g                 | 30m                    | S/FTP only    |                               |
- UTP
- STP
	- shielding also grounded
- crosstalk
	- can be measured with cable tester
	- near end cross talk (NEXT)
		- at transmitting end, when crosstalk is strongest
		- `NEXT (db) = 10log(signal/crosstalk)`
		- less crosstalk = higher NEXT = better
	- far end cross talk (FEXT)
		- at weakest point
	- alien crosstalk (AXT)
		- from other cables
	- ACR attenuation to crosstalk ratio
		- `ACR = NEXT - attenuation`
			- attenuation / signal loss / insertion loss → lower is better
			- NEXT → higher is better
			- ∴ higher ACR = better
- Common cable issues
	- cables not punched down into connector well
	- altered internal geometry
		- not enough twisting due to pulling or stretching
		- minimum bend radius exceeded
		- cables stapled
		- cable ties too tight. velcro straps better
	- EMI interference
		- power cords, fluorescent lights, fire prevention, other electrical systems
	- Cables mixed up in pins
		- can sometimes be auto-corrected by router (Auto-MDX)

## *Switches*
- *access ports*
	- *belong to single VLAN*
	- *connect switches to end-user devices*
	- *only sends and receives untagged frames*
	- *outgoing: when frame enters access port, the switch adds the associated VLAN tag*
		- *exception: if receives a frame with native VLAN tag, switch strips that tag and broadcasts it forward*
		- *double-tagging exploits this behavior*
	- *incoming: when a tagged frame is goes out that access port, the switch removes the tag beforehand*
- *trunk ports*
	- *carrying traffic for multiple VLANs*
	- *usually connecting switches/routers to other switches/routers*
- *dynamic ports*
	- *can switch between trunk and access*
	- *switch spoofing exploits this*
	- *outside scope of net+*
- *hybrid ports*
	- *can handle both tagged and untagged frames*
	- *outside scope of net+*
## *Interface Issues*
- *damaged port / broken pins*
- *dirty / corroded contacts*
- *SNMP statistics*
	- *link status - up/down*
	- *utilization - % throughput/bandwidth*
	- *error rates*
		- *CRC*
			- *packets whose payload did not match CRC checksum*
		- *runts*
			- *smaller than minimum 64byte ethernet frame. causes:*
				- *collisions on half-duplex network. both ends transmit at same time --> collision*
				- *bad cabling*
		- *giants*
			- *larger than max 1518 byte ethernet frame. causes:*
				- *malfunctionin NIC*
				- *bad cabling*
			- *different than jumbo frame (9000 bytes)*
		- *packet drop*
			- *congestion / buffer overflow*
			- *security related drop*
				- *VLAN tagged frames on an access port*
				- *unknown VLAN tag on a trunk port*
			- *bad cabling*
- *Interface off States*
	- *Error Disabled interfaces - Many interfaces self-disable. when?*
		- *link flapping up/down*
		- *a new mac is plugged into secured port*
		- *duplex mismatch detected*
	- *Administratively down interfaces - turned off by the admin*
	- *Suspended interfaces*
		- *incorrectly connected. such as one end of cable set to LACP, but other is not*

## *Ethernet frame*
*![[image-11.png]]*
- *preamble and start frame delimiter usualyl not shown by packet sniffer*
- *preamble - synchronizes clock*
- *SFD - fixed sequence just to start parsing*
- *EtherType - ipv4 / ipv6 / ARP / LLDP*
	- *LLDP are regularly sent out messages to all direct neighbors saying "I exist, this is who I am"*
	- *SNMP can query the MIB on each device for its LLDP table, and then construct the entire network topology*
- *FCS - frame check sequence*
	- *checked by CRC*

## *Hardware Issues*
- *PoE*
	- *typically used by VoIP, CCTV, WAPs*
	- *power source*
		- *Endspan - switch itself*
		- *Midspan - inline power injector*
	- *sometimes switch may have multiple PoE ports, but a maximum PoE wattage*
- *for fiber optic*
	- *single mode transceivers for single mode fiber*
	- *transceiver wavelength (850nm, 1310nm, etc) must match cable wavelgnth*
- *transceiver signal strength*
	- *if `transmitter power (dBm) - total link loss (dB) < transceiver sensitivity (dBm)` then the will have errors.* 
	- *total link lsos is a funciton of distance (attenuation), connectors, and splices (permanently connection between 2 fibers)*

|                    | IEEE Standard | Max. Power | Twisted Pairs Used | Cable Requirement | Common Devices                                        |
| ------------------ | ------------- | ---------- | ------------------ | ----------------- | ----------------------------------------------------- |
| **PoE (Type 1)**   | 802.3af       | 15.4W      | 2-Pair             | Cat3 or better    | VoIP phones, simple IP cameras                        |
| **PoE+ (Type 2)**  | 802.3at       | 25.5W      | 2-Pair             | Cat5 or better    | Video IP phones, Pan-Tilt-Zoom cameras, advanced WAPs |
| **PoE++ (Type 3)** | 802.3bt       | 51W        | 4-Pair             | Cat5e or better   | Video conferencing systems, laptops, digital signage  |
| **PoE++ (Type 4)** | 802.3bt       | 71W        | 4-Pair             | Cat5e or better   | Video conferencing systems, laptops, digital signage  |

## *Network Issues*
- *on MAC layer, there is no mechanism (i.e. TTL) for counting hops / preventing loops.* 
- *VLAN issues*
	- *if device cant communicate, its VLAN might be misconfigured*
	- *every port on eery switch is associted wtih a VLAN.*
		- *if single VLAN / single device - access port*
- *if all switches and routers configured correclty, but things still not commnuicating well, might be ACLs*
	- *remember that the default behavior for ACL, if doesnt match any criteria, is deny*
	- *tehre for enabling ACLs but not defining any rules → interpreted as deny all traffic*

## *Router Issues*
- *routing tables can be wrong*
- *`ICMP host unreachable` = there does not exist a route to the destination*
- *gateway of last resort: use a static default route so that if no route is found, instead of dropping,  it goes there*
	- *usualy 0.0.0.0/0, which has been set to point to the internet/the ISP*
- *we might have run out of addresses on DHCP server*
	- *how to know this is the problem? then we would receive APIPA ip address.* 
	- *how to solve?*
		- *use IPAM to manage IPs*
		- *lower lease time for IPs*
- *usual steps*
	- *ping/traceroute yourself local host*
	- *ping/traceroute your default gateway*
	- *ping/traceroute an outside address*
- *Duplicate ip addresses. how can this happen?*
	- *usually 2 devices configred with same static ip*
	- *but also can happen when 2 DHCP servers overlap (2nd server did not receive 'request' choice from when ip was assigned in DORA process)*
	- *how to prevent?*
		- *always try pinging an ip before setting it as static*

## *Performance Issues*
- *congestion*
	- *too many packets arriving, buffer overflows, packets dropped*
	- *look at bandwidth % and throughput statistics*
		- *in SNMP or NetFlow*
- *latency*
	- *delay from request and response*
- *packet loss*
	- *bad wireless*
	- *bad cable*
	- *not enough bandwidth*
	- *security discard*
- *jitter*
	- *real-time media: voip and live streams*
	- *but if we miss a packet, cant re-send → jitter.* 

## *Wireless Issues*
- *in reality, each device on wireless is only talking 1 at a time. avoids simultaenous via CSMA/CA (carrier sense multiple access with collison avoidance)*
- *how to avoid slowdowns?*
	- *configure WAP to always uses the newest fastest wireless standard available.*
	- *avoid channel overlaps, or automatic channel overlap avoidance*
	- *turn down WAP power of 1 router so it interferees less with others*
	- *add more WAPs to split load*
- *wireless signals also experience attenuation. solutions?*
	- *increase output power*
	- *use an antenna with higher receive gain*
	- *limit the amount of cable between the access point and the antenna.*
- *client disassociation issues*
	- *device keeps dropping from wireless network*
		- *usually a denial of service attack, forged de-authentication frames.*
		- *since wifi 6 / 802.11ax, mandatory feature prevents de-authentication attacks*
- *roaming misconfiguration*
	- *multiple WAPs with same SSID, but if not configured the same, will have errors*

## *Software Tools*
- *protocol analyzers AKA packet sniffer AKA wireshark*
- *nmap*
	- *find open ports*
	- *find OS on each device*
	- *find services on each device*
	- *has scripting engine*
- *CDP cisco discovery protocol*
	- *LLDP is vendor neutral version*
	- *both are running on the firmware of routers and switches*
	- *only communicate with directly connected neighbors*
	- *sends a small frame every 30-60 seconds* 
	- *information per port*
		- *remote device name*
		- *remote port*
		- *remote device ip address*
		- *local port (port on reporting device)*
		- *VLAN*
	- *view this data in Wireshark or CLI of device itself: `show cdp/lldp neighbors`*
- *speed test sites*
	- *useful before and after a change*
	- *try at different times of the day*

## *Command line tools*
- *`ping`*
	- *uses ICMP*
- *`traceroute` / `tracert` (windows)*
	- *tells all routers between you and destination*
	- *tries TTL=1,2,etc to get information about each router*
	- *many firewalls drop ICMP packets*
- *`nslookup`*
	- *query a DNS server*
	- *input: domain name*
	- *output: ip*
	- *deprecated*
- *`dig`*
	- *can find all types of records, like `MX` and `NS`*
- *`tcpdump`*
	- *CLI version of wireshark*
	- *windows version: windump*
	- *data is in pcap format*
- *`netstat`*
	- *`-a` shows all active connections of who we are communicating with*
	- *`-b` in windows, shows which exes are using those connections*
	- *`-n` shows same info with IPs, not domain names*
- *`ipconfig` (`ifconfig` for linux)*
	- *whats the local ip address of this device?*
	- *usually want to use `/all`*
- *`arp -a`*
	- *view local ARP table cache on your computer*

## *Hardware Tools*
- *Tone generator*
	- *where does that wire go?*
	- *analog signal*
- *Cable test*
	- *test continuity*
	- *can find crossed wires (1 light per pin)*
	- *cant tell signal strength*
- *Taps and Port mirrors*
	- *send pakcet for packet copy of traffic*
		- *can be active or passive*
		- *requires downtime because connection must be broken and placed in between*
	- *software based: port mirror AKA SPAN, send copy all traffic from 1 port to another port*
		- *possible problem: oversubscription. the destination port of copied trafic may be exceeded*
- *Wireless survery tool*
	- *software*
	- *hardware: wifi-analyzer*
	- *interference from microwave or non-wifi? spectrum analyzer*
- *Visual Fault locator*
	- *fiber optic cable working?*
	- *shines light down wire to identify breaks*

## *Network Device Commands*
- *switch: `show mac-address-table`*
- *router: `show route`*
- *both: `show interface`*
	- *up? down? disabled? duplex*
	- *speed, MTU (max size before fragment),* 
	- *encapsulation type*
		- *ethernet (most common)*
		- *PPP (aka dialup)*
		- *dot1q (trunk port w VLAN tags)*
		- *QinQ (trunk port with stacked VLANs, nested VLAN tags)*
	- *CRC errors, drops, total frames, broadcasts*
- *`show config`*
	- *text-based view of device's config*
- *`show arp`*
	- *show arp table inside switch/router*
- *`show vlan`*
	- *which vlans are associated with which interfaces*
- *`show power`*